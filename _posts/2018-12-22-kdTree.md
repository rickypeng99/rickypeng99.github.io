---
layout: post
key: 20181220
title: k-dimensional tree (多维空间树) 的实现与应用
tags:
- Academic
- Chinese
- Data Structures
mathjax: true
mathjax_autoNumber: true
---
## 1. 导言
### 1.1 什么是kd-tree
顾名思义，kd-tree是一种能够储存多维数据的数据结构。kd-tree的本质是一棵递归实现的二叉树，但是每个树节点都可以被视作一个将当前空间划为两个半空间(Half-space)的超平面(Hyperplane)。
每个节点的子树代表了位于该节点所代表的超平面所切割开来的两部分。例如，如果该超平面是一个平行于x轴的超平面，那么左子树和右子树的节点则会按照根据他们的y值进行划分，因此高于
该超平面的数据就会被分在右子树，而低于该超平面的数据则会被分在左子树。
上面的描述有些抽象，可能会对读者的阅读造成不便，以下是一个更加易懂的例子：
每个节点所代表的超平面实际上是有在当前维度所有数据的中点(middle most element)来表示的。例如，假设我们把所有人类按照三维的数据划分, 一个人的存在可以用三个特征作为表示：（身高，
智商和颜值），那么我们在构建一个可以存储所有人类的信息的kd树时，我们假设在某个节点代表了将剩余（还未存入树中）的人类通过身高维度进行划分的超平面，我们可以通过算法得出当前维度的中点身高值为180cm，这个180cm则代表了一个将剩余人类正好通过身高这么一个维度划分为两个群体的超平面。因此，身高高于一米八的人会被分到右子树，身高矮于一米八的人会被分到左子树。

### 1.2 kd树的作用
我们通常使用普通的数据结构（例如：平衡二叉树）来进行检索一维的数据。比如，我们想要检索“一只攻击力为3000左右的怪兽”，那么平衡二叉树则会用$$O(log n)$$的时间复杂度来返回我们所需要的结果。$$O(log n)$$自然是相当快的算法。但是如果我们想要基于h多维的键值进行搜索呢？比如，我们想要检索“一只攻击力为3000左右，防御力为2000左右，等级为10左右的怪兽”。如果我们使用平衡二叉树的话，首先我们需要找到所有攻击力为3000左右的怪兽的集合，我们还需要找所有防御力2000左右的怪兽的集合，我们还需要找到所有等级为10左右的怪兽的集合，最后再从这三个集合的交集得出能同时满足的以上三个特征的怪兽的集合。假设每个集合的怪兽量为n，我们则需要$$O(n^3)$$复杂度的才能实现一次检索！$$O(n^3)$$显然是非常慢的算法。但是，kd树却可以在这种场合我们提供更好的结果。由于kd树可以利用多个维度来进行节点划分，我们可以用$$O(log n)$$的复杂度来检索出我们所需要的集合！

### 2.1 kd树的构建
上文我们提到了kd树的基本概念和构造。那么，我们如何将一组数据有效的存入

一个三维的kd-tree的
